YUI.add("gallery-timespinner",function(A){YUI().add("gallery-timespinner",function(C){var F=C.Lang,D=C.Widget,Q=C.Node,G=C.ClassNameManager.getClassName,L="timespinner",H="lock",K="hour_12",S="hour_24",M="minutes",E="seconds",I="sep",O="am_pm",N="updown",J="plus",P="minus";function B(T){B.superclass.constructor.apply(this,arguments);}B.NAME="timespinner";B.ATTRS={hourtype:{value:"24"},sep:{value:":"},seconds:{value:true},timepsan:{value:{required:false,sep:" - "}},holder:{value:""}};B.HTML_PARSER={};function R(T){return(T<10)?"0"+T:T;}C.extend(B,C.Widget,{initializer:function(){},destructor:function(){this._documentMouseUpHandle.detach();},renderUI:function(){this._renderTimeSelector();},getValue:function(){var U=this.get("contentBox");var V=U.get("firstChild");var Y=V.get("childNodes");var Z=Y.get("childNodes").length;var T="";for(var W=0;W<Z;W++){var X=Y.get("childNode")[W];if(X.get("tagName")==="DIV"&&X.get("className")!==G(L,N)){T=T+Y.get("childNode")[W].get("innerHTML");}else{T=T+Y.get("childNode")[W].get("value");}}return T;},bindUI:function(){this.after("valueChange",this._afterValueChange);var T=this.get("contentBox");T.on("focus",C.bind(this._onTimeSegClick,this),"."+G(L,L));T.on("mousedown",C.bind(this._onMouseDown,this),"."+G(L,N));this._documentMouseUpHandle=T.on("mouseup",C.bind(this._onMouseUp,this),document);var U=(!C.UA.opera)?"down:":"press:";U+="38, 40, 33, 34";C.on("key",C.bind(this._onDirectionKey,this),T,U);C.on("change",C.bind(this._onInputChangeValid,this),"input");},syncUI:function(T){this._uiSetValue(T);},_renderTimeSelector:function(){var T=this.get("contentBox"),X=this.get("timepsan"),V=Q.create(this._makeDiv(L)),W,U;this._makeClock(V);if(X.required){V.appendChild(Q.create(this._makeDiv(I,X.sep)));this._makeClock(V);}W=Q.create(this._makeDiv(N));W.appendChild(Q.create(this._makeButton(J)));W.appendChild(Q.create(this._makeButton(P)));V.appendChild(W);T.appendChild(V);C.one(this.get("holder")).appendChild(T);U=C.all(".yui3-timespinner-timespinner");U.plug(C.Plugin.NodeFocusManager,{descendants:"input[type=text]",keys:{next:"down:39",previous:"down:37"}});},_makeClock:function(V){var U=this.get("hourtype");var T=Q.create(this._makeInPut(U==="12"?K:S,"00"));V.appendChild(T);V.appendChild(Q.create(this._makeDiv(I,this.get("sep"))));V.appendChild(Q.create(this._makeInPut(M,"00")));if(this.get("seconds")){V.appendChild(Q.create(this._makeDiv(I,this.get("sep"))));V.appendChild(Q.create(this._makeInPut(E,"00")));}if(U==="12"){V.appendChild(Q.create(this._makeInPut(O,"AM")));}},_makeDiv:function(U,W){var T=G(L,U),V;if(arguments.length>1){V='<div class="'+T+'">'+W+"</div>";}else{V='<div class="'+T+'"></div>';}return V;},_makeButton:function(V,W){var T=G(L,V),U='<input type="button" class="'+T+'" aria-label="'+V+'"/>';return U;},_makeInPut:function(U,W){var T=G(L,U),V='<input type="text" class="'+T+'" value="'+W+'" aria-label="'+U+'"/>';return V;},_onMouseDown:function(X){var V=C.one("."+G(L,H)),W=false,U,T;if(V){var Y;if(X.target.get("parentNode").get("parentNode").contains(V)){U=V.get("className").split(" ");T=X.target.get("className");switch(T){case G(L,J):Y=this._up;this._preInputChange(V,this._up,U[0]);W=true;break;case G(L,P):Y=this._down;this._preInputChange(V,this._down,U[0]);W=true;break;}}if(W){this._setMouseDownTimers(V,U[0],Y);}}},_onTimeSegClick:function(V){var T=V.target.get("className"),U;if(T!==""){switch(T){case G(L,K):case G(L,S):case G(L,M):case G(L,E):case G(L,O):U=V.target;this._lockandload(U);break;}}},_lockandload:function(U){if(!U.hasClass(G(L,H))){var T=C.all("."+G(L,H));T.removeClass(G(L,H));U.addClass(G(L,H));}else{U.removeClass(G(L,H));}},_defaultCB:function(){return null;},_onMouseUp:function(T){if(this._mouseDownTimer){this._mouseDownTimer.cancel();this._mouseDownTimer=null;}if(this._mousePressTimer){this._mousePressTimer.cancel();this._mousePressTimer=null;}},_onDirectionKey:function(U){U.preventDefault();if(U.target.hasClass(G(L,H))){var T=U.target.get("className").split(" ");switch(U.charCode){case 38:this._onInputChange(U.target,this._up(U.target.get("value"),T[0]));break;case 40:this._onInputChange(U.target,this._down(U.target.get("value"),T[0]));break;}}},_setMouseDownTimers:function(V,U,T){this._mouseDownTimer=C.later(500,this,function(){this._mousePressTimer=C.later(100,this,function(){this._preInputChange(V,T,U);},null,true);});},_clearMouseDownTimers:function(){if(this._mouseDownTimer){this._mouseDownTimer.cancel();this._mouseDownTimer=null;}},_uiSetValue:function(U){var T=C.one("."+G(L,H));if(T){T.set("value",U);}},_onInputChange:function(U,V){var T=U.get("className").split(" ");if(this._validateValue(U.get("value"),T[0])){this.syncUI(V);}else{T[0]===G(L,O)?this.syncUI("AM"):this.syncUI("01");}},_preInputChange:function(V,U,T){this._onInputChange(V,U(V.get("value"),T));},_onInputChangeValid:function(T){this._onInputChange(T.target,T.target.get("value"));},_validateValue:function(U,T){switch(T){case G(L,K):U=(+U);return(F.isNumber(U)&&U>=0&&U<=12);case G(L,S):U=(+U);return(F.isNumber(U)&&U>=1&&U<=24);case G(L,O):if(U==="AM"||U==="PM"){return true;}else{return false;}break;default:U=(+U);return(F.isNumber(U)&&U>=0&&U<=59);}},_up:function(U,T){switch(T){case G(L,K):switch(U){case"12":return R(1);default:return R((+U)+1);}break;case G(L,S):switch(U){case"23":return R(0);default:return R((+U)+1);}break;case G(L,M):case G(L,E):switch(U){case"59":return R(0);default:return R((+U)+1);}break;case G(L,O):return U==="AM"?"PM":"AM";}},_down:function(U,T){switch(T){case G(L,K):switch(U){case"01":case"00":return R(12);default:return R((+U)-1);}break;case G(L,S):switch(U){case"00":return R(23);default:return R((+U)-1);}break;case G(L,M):case G(L,E):switch(U){case"00":return R(59);default:return R((+U)-1);}break;case G(L,O):return U==="AM"?"PM":"AM";}}});C.TimeSpinner=B;},"0.01",{requires:["widget","node-focusmanager"]});},"@VERSION@",{requires:["widget","node-focusmanager"]});